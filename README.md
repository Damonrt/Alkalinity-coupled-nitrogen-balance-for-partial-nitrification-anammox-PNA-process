The partial nitrification anammox (PNA) process plays a crucial role in autotrophic nitrogen removal. However, due to the complexity of the reactions involved—such as ammonia oxidation (AOB), nitrite oxidation (NOB), anammox (ANA), nitrate reduction (DN3), and nitrite reduction (DN2)—accurately and promptly determining the activity of each reaction is challenging. This difficulty can lead to unintended NOB activity and potentially result in reactor failure.

Traditionally, nitrogen balances rely on three key equations (ΔNH4, NO2, and NO3), but these are insufficient to meet the degrees of freedom required to solve the five reactions. As a result, more advanced methods like oxygen uptake rate analysis, kinetic studies, and genetic testing are frequently employed to better understand and manage the PNA process. However, these techniques are time-consuming and primarily suited to steady-state data.

In the model presented here, alkalinity balance is introduced to complement the conventional nitrogen balance. This approach enhances data interpretation, enables early detection of operational issues, and minimizes the reliance on labor-intensive methods.

The model progresses through several key steps:

	1.	Data Input: A CSV file with a specified format is required, where rows 3-8 contain influent and effluent nitrogen concentrations, and rows 13 and 15 capture influent and effluent alkalinity, respectively. The code can be customized to accommodate different data structures.
	2.	Conventional Nitrogen Matrix Setup: The nitrogen balance is formulated into three equations, representing five unknown activities in an Ax=b format.
	3.	Scenario Generation: To address the system’s lack of degrees of freedom, six scenarios are generated by eliminating two activities and their corresponding coefficients in each scenario. Five invertible A matrices are stored for subsequent calculations.
	4.	Scenario Calculation and Negative Data Filtering: As the model numerically solves the system, any scenario resulting in negative values is deemed unrealistic and filtered out.
	5.	Data Overlap and Combination: Multiple scenarios may apply to the same data period. Here, alkalinity balance is used to calculate the alkalinity variation based on the scenario results. The scenario whose calculated variation most closely aligns with the measured alkalinity is selected as the most reliable.

This model provides a streamlined, “one-click” calculation of each individual reaction’s activity, significantly benefiting both research and industrial operations. While specifically designed for PNA, the model is adaptable to related processes, such as partial denitrification anammox and partial nitrification denitrification. Moreover, the model can be integrated with multi-location alkalinity detection, making it applicable to larger-scale systems, such as long aeration tanks, or processes involving multiple reactors, such as post-clarification and distinct stages with recycling.
